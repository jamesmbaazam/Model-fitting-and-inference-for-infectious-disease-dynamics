<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title>Example: Tristan da Cunha outbreak &amp; the SEITL model.</title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
  </style>
  <link rel="stylesheet" href="github-pandoc.css" type="text/css" />
  <script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
</head>
<body>
<div id="header">
<h1 class="title">Example: Tristan da Cunha outbreak &amp; the SEITL model.</h1>
</div>
<div id="TOC">
<ul>
<li><a href="#deterministic-vs-stochastic-simulations">Deterministic vs Stochastic simulations</a><ul>
<li><a href="#deterministic-simulations">Deterministic simulations</a></li>
<li><a href="#stochastic-simulations">Stochastic simulations</a></li>
</ul></li>
<li><a href="#exponential-vs-erlang-distributions">Exponential vs Erlang distributions</a></li>
</ul>
</div>
<p>Based on the description of the outbreak above and the information found in the literature we can make the following guess estimates:</p>
<ol style="list-style-type: decimal">
<li>Since the Tristan population is a close knit community, <span class="math">\(R_0\)</span> was probably above 2 during the outbreak. Let's assume <span class="math">\(R_0=4\)</span>.</li>
<li>Both the latent (<span class="math">\(D_\mathrm{lat}\)</span>) and infectious (<span class="math">\(D_\mathrm{inf}\)</span>) periods are equal to 2 days.</li>
<li>The average duration of immunity (<span class="math">\(D_\mathrm{imm}\)</span>) is equal to 15 - 2 = 13 days.</li>
<li>Since not all seroconverted individuals acquire a long-term protective against reinfection, let's assume <span class="math">\(\alpha=0.70\)</span></li>
<li>Assuming 80% of symptomatic and 85% of the cases reported in the data, we obtain an overall reporting rate <span class="math">\(\rho=0.8\times0.85 \sim 0.7\)</span>.</li>
<li>The 2 islanders with symptoms at disembarkation are infectious: <span class="math">\(I(t=0)=2\)</span>.</li>
<li>The 3 islanders who were ill during the 8-day journey are temporary protected at disembarkation: <span class="math">\(T(t=0)=3\)</span>.</li>
<li>No islander was immune at the beginning of the epidemic.</li>
</ol>
<p>Now, you can now go back to the <a href="play_with_seitl.html#deterministic-vs-stochastic-simulations">practical</a> and check whether these estimates provides a good fit to the data.</p>
<h1 id="deterministic-vs-stochastic-simulations">Deterministic vs Stochastic simulations</h1>
<h2 id="deterministic-simulations">Deterministic simulations</h2>
<p>Let's simulate the SEITL model with our initial guess <code>theta</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r">theta.guess1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">R0 =</span> <span class="dv">4</span>, <span class="dt">D.lat =</span> <span class="dv">2</span>, <span class="dt">D.inf =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.7</span>, <span class="dt">D.imm =</span> <span class="dv">13</span>, <span class="dt">rho =</span> <span class="fl">0.7</span>)
init.state.guess &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">S =</span> <span class="dv">279</span>, <span class="dt">E =</span> <span class="dv">0</span>, <span class="dt">I =</span> <span class="dv">2</span>, <span class="dt">T =</span> <span class="dv">3</span>, <span class="dt">L =</span> <span class="dv">0</span>, <span class="dt">Inc =</span> <span class="dv">0</span>)
<span class="kw">plotFit</span>(SEITL_deter, theta.guess1, init.state.guess, <span class="dt">data =</span> FluTdC1971, <span class="dt">n.replicates =</span> <span class="dv">100</span>)</code></pre>
<p><img src="figure/SEITL_play_example/guess-1.png" title="" alt="" width="500" style="display: block; margin: auto;" /></p>
<p>This set of parameters provides a poor fit, in particular the first wave too small. Let's increase <span class="math">\(R_0\)</span>:</p>
<pre class="sourceCode r"><code class="sourceCode r">theta.guess2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">R0 =</span> <span class="dv">10</span>, <span class="dt">D.lat =</span> <span class="dv">2</span>, <span class="dt">D.inf =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.7</span>, <span class="dt">D.imm =</span> <span class="dv">13</span>, <span class="dt">rho =</span> <span class="fl">0.7</span>)
<span class="kw">plotFit</span>(SEITL_deter, theta.guess2, init.state.guess, <span class="dt">data =</span> FluTdC1971, <span class="dt">n.replicates =</span> <span class="dv">100</span>)</code></pre>
<p><img src="figure/SEITL_play_example/guess-2.png" title="" alt="" width="500" style="display: block; margin: auto;" /></p>
<p>The size of the first wave is now ok but the second wave is too small. Let's decrease <span class="math">\(\alpha\)</span>, thus allowing more islanders to be reinfected:</p>
<pre class="sourceCode r"><code class="sourceCode r">theta.guess3 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">R0 =</span> <span class="dv">10</span>, <span class="dt">D.lat =</span> <span class="dv">2</span>, <span class="dt">D.inf =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.4</span>, <span class="dt">D.imm =</span> <span class="dv">13</span>, <span class="dt">rho =</span> <span class="fl">0.7</span>)
<span class="kw">plotFit</span>(SEITL_deter, theta.guess3, init.state.guess, <span class="dt">data =</span> FluTdC1971, <span class="dt">n.replicates =</span> <span class="dv">100</span>)</code></pre>
<p><img src="figure/SEITL_play_example/guess-3.png" title="" alt="" width="500" style="display: block; margin: auto;" /></p>
<p>This is a descent eyeball fit given that we have 6 parameters. However, we note that many data point are not captured by the model, even accounting for variability of the observation process.</p>
<p>Now, you can now go back to the <a href="play_with_seitl.html#stochastic-simulations">practical</a> and check whether the stochastic model provides a better fit to the data.</p>
<h2 id="stochastic-simulations">Stochastic simulations</h2>
<p>Let's try the stochastic SEITL model with our best guess from the previous section.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plotFit</span>(SEITL_stoch, theta.guess3, init.state.guess, <span class="dt">data =</span> FluTdC1971, <span class="dt">n.replicates =</span> <span class="dv">100</span>, 
    <span class="dt">p.extinction =</span> <span class="ot">TRUE</span>)</code></pre>
<p><img src="figure/SEITL_play_example/guess-3-stoch.png" title="" alt="" width="1000" style="display: block; margin: auto;" /></p>
<p>The stochastic model better accounts for the variability in the data. In addition, demographic stochasticity can lead to stochastic extinctions at the beginning and at the end of the outbreak when the number of infectious individuals is low and the chain of transmission can break if by chance they recover before infecting a secondary case. By contrast, the cumulative extinction probability doesn't increase between the two waves, despite the low incidence observed in the data. Note however that the shape of the second wave is quite flat in comparison to the data.</p>
<p>Now, you can now go back to the <a href="play_with_seitl.html#exponential-vs-erlang-distributions">practical</a> and check how we can make this model a bit more realistic.</p>
<h1 id="exponential-vs-erlang-distributions">Exponential vs Erlang distributions</h1>
<p>Let's simulate the stochastic SEIT2L model with our last guess estimates. Note that we need to change the vector of initial states.</p>
<pre class="sourceCode r"><code class="sourceCode r">init.state.guess.SEIT2L &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">S =</span> <span class="dv">279</span>, <span class="dt">E =</span> <span class="dv">0</span>, <span class="dt">I =</span> <span class="dv">2</span>, <span class="dt">T1 =</span> <span class="dv">3</span>, <span class="dt">T2 =</span> <span class="dv">0</span>, <span class="dt">L =</span> <span class="dv">0</span>, <span class="dt">Inc =</span> <span class="dv">0</span>)
<span class="kw">plotFit</span>(SEIT2L_stoch, theta.guess3, init.state.guess.SEIT2L, <span class="dt">data =</span> FluTdC1971, 
    <span class="dt">n.replicates =</span> <span class="dv">100</span>, <span class="dt">p.extinction =</span> <span class="ot">TRUE</span>)</code></pre>
<p><img src="figure/SEITL_play_example/guess-3-stoch-SEIT2L.png" title="" alt="" width="1000" style="display: block; margin: auto;" /></p>
<p>With the SEIT2L model the shape of the second epidemic wave is better captured. To explain this, we first note that for the same expected duration, the Erlang distribution with shape <span class="math">\(k\)</span> has a variance <span class="math">\(k\)</span> times smaller than that of the exponential distribution. Accordingly, recovered individuals stay temporarily protected for similar durations. Consequently, those who do not develop long-term protection go back to the susceptible compartment approximately at the same time. This sudden inflow of susceptible individuals can initiate a bigger second wave.</p>
<p>You've already finished? why not <a href="play_with_seitl.html#going-further">going further?</a></p>
</body>
</html>
